{"componentChunkName":"component---src-templates-blog-post-js","path":"/proxy/proxy/","result":{"data":{"site":{"siteMetadata":{"title":"Tech Notes and some other stuff"}},"markdownRemark":{"id":"2de5fff6-90ae-52da-876b-b9433286e478","excerpt":"How to set up a forward proxy? nginx as forward proxy - did not work with authentication I tried to set up nginx as forward proxy on my Windows machine and itâ€¦","html":"<p><strong>How to set up a forward proxy?</strong></p>\n<p><strong>nginx as forward proxy - did not work with authentication</strong></p>\n<p>I tried to set up nginx as forward proxy on my Windows machine and it did not work. Well, it did work when the proxy was not configured for authentication. </p>\n<p>This was how I set it up.</p>\n<p>I used a docker image reiz/nginx_proxy as I read that nginx docker image does not work for https sites.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">docker run -d -p 8888:8888 -v /d:/misc/dockerfiles/nginx/conf/nginx_whitelist.conf:/usr/local/nginx/conf/nginx.conf reiz/nginx_proxy</code></pre></div>\n<p>This proxy works for both https and https sites.</p>\n<p>Then I set up authentication for the proxy:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">docker run -d -p 8888:8888 -v /d:/misc/dockerfiles/nginx/conf/nginx_whitelist.conf:/usr/local/nginx/conf/nginx.conf -v /d:/misc/dockerfiles/xampp/apache/bin/.htpasswd:/var/passwd/nginx/.htpasswd reiz/nginx_proxy</code></pre></div>\n<p>config file</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">user www-data;\nworker_processes auto;\ndaemon off; # Don&#39;t run Nginx as daemon, as we run it in Docker we need a foreground process.\nevents { }\n\n\nhttp {\n    server_names_hash_bucket_size 128;\n\n    access_log /var/log/nginx_access.log;\n    error_log /var/log/nginx_errors.log;\n\n    # Whitelist All\n    server {\n        listen       8888;\n\tserver_name   ~.;\n\tauth_basic &quot;Restricted&quot;;\n        auth_basic_user_file /var/passwd/nginx/.htpasswd;\n        proxy_connect;\n        proxy_max_temp_file_size 0;\n        resolver 8.8.8.8;\n        location / {\n           proxy_pass http://$http_host;\n           proxy_set_header Host $http_host;\n        }\n    }\n\n    # Everything else is denied\n    server {\n        listen       8888;\n        return 404;\n    }\n\n}</code></pre></div>\n<p>There are online tool generators for generating .htpasswd file.</p>\n<p><strong>Squid forward proxy</strong></p>\n<p>It was very easy to set up Squid on my Windows machine.</p>\n<p>I followed the instructions below for setting up a basic http forward proxy sans autehntication.</p>\n<p><a href=\"https://www.youtube.com/watch?v=bSHCiZq2TrU\">https://www.youtube.com/watch?v=bSHCiZq2TrU</a></p>\n<p>Then followed the instructions below to set up authentication:</p>\n<p><a href=\"https://gist.github.com/yvanin/ef831720112c1f6ee8c3\">https://gist.github.com/yvanin/ef831720112c1f6ee8c3</a></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">auth_param basic program &quot;/lib/squid/basic_ncsa_auth.exe&quot; &quot;/etc/squid/.htpasswd&quot;\nacl ncsa_users proxy_auth REQUIRED\nhttp_access allow ncsa_users</code></pre></div>\n<p><strong>HTTPS Proxy</strong></p>\n<p>Setting up an https proxy looked not so easy on Squid. Hence, I tested my application just using http proxy and hope it would work just find with HTTP proxy.</p>","frontmatter":{"title":"Proxy","date":"April 03, 2020","description":"Proxy basics"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/proxy/proxy/","previous":{"fields":{"slug":"/apache-flink/"},"frontmatter":{"title":"Getting started with Apache Flink"}},"next":{"fields":{"slug":"/kubernetes/kubernetes/"},"frontmatter":{"title":"Getting started with Kubernetes"}}}}}